{"body":"spitfire.js\r\n===========\r\n\r\nYet another pile of shims.\r\n\r\nBackground\r\n-------------\r\n\r\nThere exist numerous projects providing \"shims\" for various \"aspects\" of the modern web.\r\n\r\nThough, these are usually provided in a rather monolithic/standalone/raw form, and there are few\r\n\"shims frameworks\" that would provide a from the get-go working solution to shim multiple aspects \r\nat once.\r\n\r\nFurthermore, we wanted something that would conditionally load shims, based on tests, something that\r\nwouldn't make assumptions on the loader being used, and something where shims are granular.\r\n\r\nContent\r\n-------------\r\n\r\nWe provide very few new shims, but rather a slick solution that:\r\n- select and maintains (from upstream) the best shims\r\n- provides a detection mechanism and return a list of needed shims\r\n- focuses on the basics (pretty much ES5 and a couple of others)\r\n\r\nNote that for now it doesn't provide monolithic files: depending on the browser (say, IE), MANY files \r\nmay be loaded at runtime to patch the holes.\r\n\r\nContent:\r\n- shims: most of these are not original, and come from well known and well maintained projects\r\n- loader: a loader *interface*, that can use various backends (require, labjs, headjs, yahoo are supported for now)\r\n- shimer: a tester that decides whether a shim is needed or not\r\n- gulliver: a minimalist loader that is meant to load a unique file (async, obviously)\r\n- a suite of tests using jasmine (fetches es5-shim tests as well)\r\n\r\nTechnology\r\n-------------\r\n\r\nWe use puke (https://github.com/webitup/puke), a (inhouse) versatile python build system.\r\n\r\nWe also depend on airstrip.js (https://github.com/jsBoot/airstrip) in order to \r\nprovide dependencies at build time - though you don't require to set it up yourself and won't depend\r\non it at runtime.\r\n\r\nDependencies are listed in YAML.\r\n\r\n\r\nHow to build\r\n-------------\r\n\r\n- clone: `git clone https://github.com/jsBoot/spitfire.js`\r\n- install puke: `pip install puke`\r\n- build it as-is: `cd spitfire.js; puke all`\r\n\r\n\r\nBuild result\r\n-------------\r\n\r\nInside the build/dist directory, you will find:\r\n\r\nA manifest file (spitfire.yaml) to be used by other projects / build systems, listing relative\r\nurls to the productions.\r\n\r\nInside the build/dist/spitfire.js/VERSION/, the various productions:\r\n- shimer.js\r\n- loader.js (and loader-X.js)\r\n- gulliver.js\r\n- spitfire.js (and spitfire-X.js)\r\n- tests\r\n- \"burnscars\" (directory containing independent shims)\r\n\r\nWhat you want to use\r\n-------------\r\n\r\n... depends on how you want to integrate.\r\n\r\nIf you are starting from scratch, then you should use spitfire-X.js, where X is your favorite loader\r\n(we recommend either lab or require).\r\n\r\nIf you already have a loader in place, then use spitfire.js instead (shimer + loader abstraction).\r\n\r\nIf you don't think you need the loader abstraction either, then all you need is shimer.js - but read\r\nbelow to understand the API and in-and-outs.\r\n\r\n\r\nThe 10 seconds API\r\n-------------\r\n\r\n```\r\n<!doctype html>\r\n<html>\r\n<head>\r\n  <script src=\"//base-url-to-spitfire-dist/spitfire-lab.js\"></script>\r\n  <script type=\"text/javascript\">\r\n    var basePath = '//base-url-to-spitfire-dist/';\r\n    var shimsToLoad = Spitfire.boot();\r\n    for(var x = 0; x < shimsToLoad.length; x++)\r\n      Spitfire.loader.script(basePath + shimsToLoad[x]);\r\n    Spitfire.wait(function(){\r\n      // Ready to enjoy ES5\r\n      console.warn(\" [spitfire.js] all shims loaded\");\r\n    });\r\n  </script>\r\n</head>\r\n<body>\r\n</body>\r\n</html>\r\n```\r\n\r\nshimer.js API\r\n-------------\r\n\r\n```\r\n// If you want to ENFORCE loading patched XHR and JSON (eg: not only for the browsers that don't define the objects)\r\n// Spitfire.use(Spitfire.XHR);\r\n// Spitfire.use(Spitfire.JSON);\r\n\r\n// If you want shims that just *define* things without providing actual functionality (DANGEROUS)\r\n// Spitfire.use(Spitfire.UNSAFE);\r\n\r\n// Get the lists of required shims for that browser\r\n// Note the urls are relative to the url of the spitfire.js path\r\nvar toBeLoaded = Spitfire.boot();\r\n\r\n// To get NOT minified shims urls instead\r\n// var toBeLoaded = Spitfire.boot(true);\r\n\r\n```\r\n\r\nIf you are using AMD (at the time shimer.js is loaded), just require it instead.\r\n\r\nOnce you get the list of needed shims, it's up to you to decide how you are going to load them.\r\nYou obviously can do that your own way, or use the provided loader (see below).\r\n\r\nCoverage: for now, we try to cover everything ES5 (specifically arrays and objects methods),\r\nplus XHR, JSON, Date, console, localstorage and geolocation.\r\n\r\n\r\n\r\nloader-X.js API:\r\n-------------\r\n\r\nThe \"loader\" provides a uniform abstraction on-top of other backend loaders. Right now,\r\nthe following flavors are implemented:\r\n- requirejs\r\n- labjs\r\n- headjs\r\n- yepnope\r\n- yahoo base\r\n\r\nloader.js doesn't contain any actual loader, just the API and abstractions.\r\n\r\nloader-X.js does bundle the \"X\" loader as well (eg: \"requirejs\").\r\n\r\nSo, it's up to you to decide if you need the actual loader itself, or if you already got it by\r\nother means.\r\n\r\nThe API goes like:\r\n```\r\n/** Script loading */\r\n// Load two scripts in parallel\r\nSpitfire.loader.script(\"some_url\");\r\nSpitfire.loader.script(\"some_other_url\");\r\n// This will wait until both scripts are evaluated\r\nSpitfire.loader.wait();\r\n// Load a third script, probably depending on the two firsts\r\nSpitfire.loader.script(\"some_other_other_url\");\r\nSpitfire.loader.wait(function(){\r\n  // Do something and have the guarantee that every three scripts are there\r\n});\r\n\r\n/** Stylesheet loading */\r\nSpitfire.loader.style(\"some_css_url\", \"media\");\r\n\r\n/** Experimental */\r\n// Get a different loading queue\r\nvar newQueue = Spitfire.loader.fork();\r\n\r\n// Get the url of a specific document script\r\nvar url = Spitfire.loader.resolve(\"somenametomatch\");\r\n\r\n```\r\n\r\ngulliver.js API:\r\n-------------\r\n\r\nGulliver is a MINIMALIST loader (under 1kB), meant for ealy stage boot.\r\nIf you don't understand what all that means, and the implications, you probably don't need it.\r\n\r\nHow to use:\r\n```\r\ngulliver(function(){\r\n  // The targetted script has been loaded\r\n}, \"uri_of_the_target_script_to_load\", \"name_of_the_gulliver_script\");\r\n\r\n```\r\n\r\n\r\nspitfire-X.js API:\r\n-------------\r\n\r\nThis is just a bundle containing shimer, loader, and possibly a backend as well (eg: require).\r\nThis is the recommended file to use.\r\n\r\n\r\ntests\r\n-------------\r\n\r\nNavigate your browser to All.html.\r\n\r\nIt will default to use loader-lab, unless you add an hashtag in the url to specify another loader\r\n(eg: #loader-require).\r\n\r\nThe following additional fragments options are supported in the url:\r\n- use shimer: #use-spitfire\r\n- use shimer with unsafe shims: #use-spitfire-full\r\n- to use ES5-shim instead: #use-es5\r\n- to use minified versions of the shims: #use-min\r\n\r\nCredits\r\n-------------\r\n\r\nSome of the shims here are sourced or served as an inspiration (credits in the individual files\r\nusually):\r\n- es5-shim: https://github.com/kriskowal/es5-shim/\r\n- json3: http://bestiejs.github.com/json3/\r\n- geolocation: http://www.calormen.com/polyfill/geo.js\r\n- http://developer.mozilla.org\r\n","note":"Don't delete this file! It's used internally to help with page regeneration.","tagline":"Yet another pile of shims","name":"Spitfire.js","google":""}